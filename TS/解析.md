# TS的解析和声明规则

[参考](https://zhuanlan.zhihu.com/p/542379032)

## TS模块解析规则

`TS`模块解析方式类似`Node`模块解析规则


### 相对路径

`文件路径：/root/src/moduleA.ts`

`import { a } from './moduleA`

此时TS解析规则是：

- 先找 `/root/src/moduleA.ts` 存在则用

- 再找 `/root/src/moduleA.tsx` 存在则用

- 再找 `/root/src/moduleA.d.ts`，存在则用

- 再找 `/root/src/package.json`中看是否定义了`types`属性，有则使用`types`对应的文件

- 如果还没有，找`/root/src/moduleA/index.ts` 

- 如果还没有，找`/root/src/moduleA/index.tsx` 

- 如果还没有，找`/root/src/moduleA/index.d.ts` 

### 非相对路径

比如引用一个`npm`包

当前执行文件`/root/src/moduleB.ts`

`import { b } from npmB`

此时TS解析路径：

- `/root/src/node_modules/npmB.ts`

- `/root/src/node_modules/npmB.tsx`

- `/root/src/node_modules/npmB.d.ts`

- 找`/root/src/node_modules/npmB/package.json`中的`types`属性指向的文件

- `/root/src/node_modules/npmB/index.ts`

- `/root/src/node_modules/npmB/index.tsx`

- `/root/src/node_modules/npmB/index.d.ts`

如果还是找不到，那就到**上一层**继续按照这种规则寻找

`/root/node_modules/npmB.ts`

...

> 上面解析逻辑，是在`tsconfig.json`中的`moduleResolution: node`来设置的
