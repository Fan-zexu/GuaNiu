# 前面

这东西属于很基础的东西，每天都会用到，但是其中一些细节却很容易忽略，所以这里就记录一下。

这篇文章我觉得很不错，看了好几遍了，每次都有所收获。[上链接](https://mp.weixin.qq.com/s/dq-RHXhn9ZjlLqdV9mabpQ)

文章是关于 CommonJS与ESModule之间的区别，比如提到：

- CommonJS模块是值的拷贝，而ESModule是值的引用

- 什么是运行时加载，什么是编译时输出

- 关于循环引用的问题

不仅有理论，还有具体代码演示，非常棒。

# CommonJS

**重点：**

`CommonJS`和`ECMAScript`不是一回事，所以类似 `module`和`require`并不是JS的关键字，而仅仅是对象或者函数而已。

打印 `module`和`require`：

```js
console.log(module);
console.log(require);

// out:
Module {
  id: '.',
  path: '/Users/xxx/Desktop/esm_commonjs/commonJS',
  exports: {},
  filename: '/Users/xxx/Desktop/esm_commonjs/commonJS/c.js',
  loaded: false,
  children: [],
  paths: [
    '/Users/xxx/Desktop/esm_commonjs/commonJS/node_modules',
    '/Users/xxx/Desktop/esm_commonjs/node_modules',
    '/Users/xxx/Desktop/node_modules',
    '/Users/xxx/node_modules',
    '/Users/node_modules',
    '/node_modules'
  ]
}

[Function: require] {
  resolve: [Function: resolve] { paths: [Function: paths] },
  main: Module {
    id: '.',
    path: '/Users/xxx/Desktop/esm_commonjs/commonJS',
    exports: {},
    filename: '/Users/xxx/Desktop/esm_commonjs/commonJS/c.js',
    loaded: false,
    children: [],
    paths: [
      '/Users/xxx/Desktop/esm_commonjs/commonJS/node_modules',
      '/Users/xxx/Desktop/esm_commonjs/node_modules',
      '/Users/xxx/Desktop/node_modules',
      '/Users/xxx/node_modules',
      '/Users/node_modules',
      '/node_modules'
    ]
  },
  extensions: [Object: null prototype] {
    '.js': [Function (anonymous)],
    '.json': [Function (anonymous)],
    '.node': [Function (anonymous)]
  },
  cache: [Object: null prototype] {
    '/Users/xxx/Desktop/esm_commonjs/commonJS/c.js': Module {
      id: '.',
      path: '/Users/xxx/Desktop/esm_commonjs/commonJS',
      exports: {},
      filename: '/Users/xxx/Desktop/esm_commonjs/commonJS/c.js',
      loaded: false,
      children: [],
      paths: [Array]
    }
  }
}
```

`require`是一个函数，`module`是一个对象。
